import{a as Y}from"./chunk-U6M22WZH.js";import{a as Q,b as $}from"./chunk-DILD3EYX.js";import{f as L}from"./chunk-75J22X7U.js";import{Fa as V,Ia as r,Lb as f,Sa as R,Vb as j,Xb as A,Ya as w,_a as y,bb as d,cb as E,da as g,e as H,eb as I,f as B,fb as S,ga as p,gb as a,hb as o,ib as u,jb as M,lb as k,mb as m,nb as T,ob as D,pa as C,pb as F,qa as b,qb as z,rb as P,sb as G,ub as s,vb as h,wa as _,wb as c,yb as v,zb as O}from"./chunk-FNSXWPPW.js";var W=H(Y());var J=["*"],K=(i,l)=>l.index;function X(i,l){if(i&1&&(a(0,"li",7),s(1),o()),i&2){let t=l.$implicit;r(),c(" ",t.rule," ")}}var U=(()=>{class i{constructor(){this.letter="R",this.title="Pouvoir : Roi du regard",this.card=_.required(),this.rules=f(()=>this.card().rules.map((t,n)=>({index:n,rule:t}))),this.backgrounds=["bg-[#73B4BD]","bg-[#E6BF25]","bg-[#A8C521]","bg-[#996AC1]"],this.texts=["text-[#73B4BD]","text-[#E6BF25]","text-[#A8C521]","text-[#996AC1]"],this.borders=["border-[#73B4BD]","border-[#E6BF25]","border-[#A8C521]","border-[#996AC1]"]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=p({type:i,selectors:[["app-card"]],inputs:{letter:"letter",title:"title",card:[1,"card"]},standalone:!0,features:[v],ngContentSelectors:J,decls:15,vars:13,consts:[[1,"w-full","h-full","bg-white","rounded-3xl","relative","overflow-hidden","p-4","shadow-lg","border-4"],[1,"absolute","top-4","left-4","w-16","h-16","rounded-lg","flex","items-center","justify-center","z-20"],[1,"text-white","text-4xl","font-bold"],[1,"absolute","right-4","top-5","text-9xl","font-bold","opacity-20","z-20"],[1,"w-full","h-3/5","mt-20","relative","z-20"],[1,"absolute","bottom-6","left-6","right-6","z-20"],[1,"text-3xl","text-center","font-bold","leading-tight"],[1,"text-center","text-xl","leading-tight"],[1,"absolute","bottom-0","left-0","h-[25vw]","w-[25vw]","min-w-[300pt]","min-h-[300pt]","max-h-[500px]","max-w-[500px]","rounded-full","-translate-x-[15%]","translate-y-[15%]","opacity-20","z-10"]],template:function(n,e){n&1&&(T(),a(0,"div",0)(1,"div",1)(2,"span",2),s(3),o()(),a(4,"div",3),s(5),o(),a(6,"div",4),D(7),o(),a(8,"div",5)(9,"h2",6),s(10),o(),a(11,"ul"),I(12,X,2,1,"li",7,K),o()(),u(14,"div",8),o()),n&2&&(d(e.borders[e.card().theme||0]),r(),d(e.backgrounds[e.card().theme||0]),r(2),h(e.card().value),r(),d(e.texts[e.card().theme||0]),r(),c(" ",e.card().value," "),r(4),d(e.texts[e.card().theme||0]),r(),c(" ",e.card().title," "),r(2),S(e.rules()),r(2),d(e.backgrounds[e.card().theme||0]))},dependencies:[A],styles:["[_nghost-%COMP%]{max-width:350pt}"]})}}return i})();var Z=(i,l)=>l.index;function ee(i,l){if(i&1&&(a(0,"li",5),s(1),o()),i&2){let t=l.$implicit;r(),c(" ",t.rule," ")}}var N=(()=>{class i{constructor(){this.letter="R",this.title="Pouvoir : Roi du regard",this.card=_.required(),this.rules=f(()=>this.card().rules.map((t,n)=>({index:n,rule:t}))),this.backgrounds=["bg-[#73B4BD]","bg-[#E6BF25]","bg-[#A8C521]","bg-[#996AC1]"],this.texts=["text-[#73B4BD]","text-[#E6BF25]","text-[#A8C521]","text-[#996AC1]"],this.borders=["border-[#73B4BD]","border-[#E6BF25]","border-[#A8C521]","border-[#996AC1]"]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=p({type:i,selectors:[["app-card-verso"]],inputs:{letter:"letter",title:"title",card:[1,"card"]},standalone:!0,features:[v],decls:12,vars:11,consts:[[1,"flex","items-center","justify-center","w-full","h-full","bg-white","rounded-3xl","relative","overflow-hidden","p-4","shadow-lg","border-4"],[1,"absolute","top-4","left-4","w-16","h-16","rounded-lg","flex","items-center","justify-center","z-20"],[1,"text-white","text-4xl","font-bold"],[1,"absolute","right-4","top-5","text-9xl","font-bold","opacity-20","z-20"],[1,"text-3xl","text-center","font-bold","leading-tight"],[1,"text-center","text-xl","leading-tight"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),s(3),o()(),a(4,"div",3),s(5),o(),a(6,"div")(7,"h2",4),s(8),o(),a(9,"ul"),I(10,ee,2,1,"li",5,Z),o()()()),n&2&&(d(e.borders[e.card().theme||0]),r(),d(e.backgrounds[e.card().theme||0]),r(2),h(e.card().value),r(),d(e.texts[e.card().theme||0]),r(),c(" ",e.card().value," "),r(2),d(e.texts[e.card().theme||0]),r(),c(" ",e.card().title," "),r(2),S(e.rules()))},dependencies:[A]})}}return i})();var te=["riveCanvas"],ie=i=>({"rotate-y-180":i});function ne(i,l){if(i&1&&(a(0,"h2",2),s(1," Au tour de "),a(2,"span",11),s(3),o()()),i&2){let t=m(2);r(3),h(t.game().player)}}function re(i,l){if(i&1&&u(0,"img",8),i&2){let t=m(2);F("src","titetes/",t.card.rive,"",V)}}function ae(i,l){if(i&1){let t=M();w(0,ne,4,1,"h2",2),a(1,"div",3),k("click",function(){C(t);let e=m();return b(e.isVerso.set(!e.isVerso()))}),a(2,"div",4)(3,"div",5)(4,"app-card",6),u(5,"canvas",7,0),w(7,re,1,2,"img",8),o()(),a(8,"div",9),u(9,"app-card-verso",6),o()()(),a(10,"button",10),k("click",function(){C(t);let e=m();return b(e.changeAnimation())}),s(11," Au suivant "),o()}if(i&2){let t=m();E(t.game().player?0:-1),r(2),y("ngClass",O(5,ie,t.isVerso())),r(2),y("card",t.card),r(3),E(t.game().isRive?-1:7),r(2),y("card",t.card)}}function oe(i,l){if(i&1){let t=M();a(0,"h2",2),s(1,"La partie est finie"),o(),a(2,"button",12),k("click",function(){C(t);let e=m();return b(e.changeAnimation())}),s(3," Relancer une partie "),o()}}var ke=(()=>{class i{constructor(){this.#e=g($),this.#t=g(L),this.#i=g(Q),this.card=this.#e.card(),this.isVerso=R(!1),this.game=f(()=>(this.card=this.#e.card(),this.card&&this.loadRiveAnimation(this.card.rive),{out:this.#e.cardsOut(),deck:this.#e.cards(),player:this.#e.currentPlayer(),card:this.#e.card(),isRive:!this.card?.rive.endsWith(".png")})),this.riveUrl="le_titube.riv",this.riveInstance=null}#e;#t;#i;ngOnInit(){window.addEventListener("resize",this.onResize.bind(this))}ngAfterViewInit(){setTimeout(()=>{this.loadRiveAnimation()})}ngOnDestroy(){window.removeEventListener("resize",this.onResize.bind(this))}loadRiveAnimation(t){return B(this,null,function*(){if(this.canvas)try{this.riveInstance=new W.Rive({canvas:this.canvas.nativeElement,src:this.riveUrl,autoplay:!0,artboard:"lesTitous",onLoad:()=>{t&&this.riveInstance?.play(t)}}),this.riveInstance.resizeToCanvas(),this.riveInstance.resizeDrawingSurfaceToCanvas(),console.log(this.riveInstance)}catch(n){console.error("Erreur lors du chargement de l'animation Rive:",n)}})}onResize(){if(this.riveInstance?.stop(),this.canvas&&this.riveInstance){let t=this.canvas.nativeElement,n=t.parentElement;n&&(t.width=n.clientWidth,t.height=n.clientHeight,this.loadRiveAnimation())}}changeAnimation(){this.isVerso.set(!1);let t=this.#i.getNextCardIndex(),n=this.#t.usernames(),e=this.#e.currentPlayer(),x=0;e&&(x=(n.indexOf(e)+1)%n.length),this.#e.addCarteOut(this.#e.cards()[t]),this.#e.setCurrentPlayer(n[x]),console.log(this.game()),this.riveInstance&&this.game().isRive&&console.log({riveCard:this.card?.rive,riveInstance:this.riveInstance.contents})}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=p({type:i,selectors:[["app-game"]],viewQuery:function(n,e){if(n&1&&z(te,5),n&2){let x;P(x=G())&&(e.canvas=x.first)}},standalone:!0,features:[v],decls:3,vars:1,consts:[["riveCanvas",""],[1,"flex","flex-col","justify-center","items-center","h-full"],[1,"text-4xl","font-bold"],[1,"relative","w-[80%]","h-full","perspective",3,"click"],[1,"relative","w-full","h-full","duration-700","preserve-3d",3,"ngClass"],[1,"absolute","w-full","h-full","backface-hidden"],[1,"block","w-full","h-full",3,"card"],["id","riveCanvas"],[1,"absolute","top-0","bottom-0","left-0","right-0","m-auto",3,"src"],[1,"absolute","w-full","h-full","backface-hidden","rotate-y-180"],["routerLink","/lobby",1,"rounded-lg","py-2","px-4","h-[70pt]","bg-orange-500","w-[80%]","text-white","text-3xl","my-5",3,"click"],[1,"text-[#FA7B53]","font-bold"],[1,"rounded-lg","py-2","px-4","h-[70pt]","bg-orange-500","w-[80%]","text-white","text-3xl","my-5",3,"click"]],template:function(n,e){n&1&&(a(0,"div",1),w(1,ae,12,7)(2,oe,4,0),o()),n&2&&(r(),E(e.card?1:2))},dependencies:[U,N,j],styles:["canvas[_ngcontent-%COMP%]{width:100%;height:100%}.perspective[_ngcontent-%COMP%]{perspective:1000px}.preserve-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.backface-hidden[_ngcontent-%COMP%]{backface-visibility:hidden}.rotate-y-180[_ngcontent-%COMP%]{transform:rotateY(180deg)}"]})}}return i})();export{ke as GameComponent};
