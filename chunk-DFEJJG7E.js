import{a as U}from"./chunk-GU5EQDAC.js";import{a as Y}from"./chunk-WBQDXDG7.js";import{f as Q,g as q}from"./chunk-PP2JOY7W.js";import{$b as L,Ab as s,Bb as f,Cb as p,Eb as x,Fb as k,Ja as V,Ma as r,Rb as g,Wa as B,ab as E,bc as A,cb as h,e as $,f as R,fb as l,ga as b,gb as I,ja as u,jb as F,kb as P,lb as a,mb as o,nb as v,ob as M,qb as S,rb as m,sa as _,sb as D,ta as y,tb as z,ub as T,wb as O,xb as G,yb as j,za as w}from"./chunk-IUI3B2L4.js";var d=$(Y());var J=["*"],H=(()=>{class i{constructor(){this.letter="R",this.title="Pouvoir : Roi du regard",this.card=w.required(),this.rules=g(()=>this.card().rules.map((e,n)=>({index:n,rule:e}))),this.backgrounds=["bg-[#73B4BD]","bg-[#E6BF25]","bg-[#A8C521]","bg-[#996AC1]"],this.texts=["text-[#73B4BD]","text-[#E6BF25]","text-[#A8C521]","text-[#996AC1]"],this.borders=["border-[#73B4BD]","border-[#E6BF25]","border-[#A8C521]","border-[#996AC1]"]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=u({type:i,selectors:[["app-card"]],inputs:{letter:"letter",title:"title",card:[1,"card"]},standalone:!0,features:[x],ngContentSelectors:J,decls:12,vars:13,consts:[[1,"w-full","h-full","bg-white","rounded-3xl","relative","overflow-hidden","p-4","shadow-lg","border-4"],[1,"absolute","top-4","left-4","w-16","h-16","rounded-lg","flex","items-center","justify-center","z-20"],[1,"text-white","text-4xl","font-bold"],[1,"absolute","right-4","top-5","text-9xl","font-bold","opacity-20","z-20"],[1,"w-full","h-3/5","mt-20","relative","z-20"],[1,"absolute","bottom-[20px]","z-20","w-full","left-0"],[1,"text-3xl","text-center","font-bold","leading-tight"],[1,"absolute","bottom-0","left-0","h-[25vw]","w-[25vw]","min-w-[300pt]","min-h-[300pt]","max-h-[500px]","max-w-[500px]","rounded-full","-translate-x-[15%]","translate-y-[15%]","opacity-20","z-10"]],template:function(n,t){n&1&&(D(),a(0,"div",0)(1,"div",1)(2,"span",2),s(3),o()(),a(4,"div",3),s(5),o(),a(6,"div",4),z(7),o(),a(8,"div",5)(9,"h2",6),s(10),o()(),v(11,"div",7),o()),n&2&&(l(t.borders[t.card().theme||0]),r(),l(t.backgrounds[t.card().theme||0]),r(2),f(t.card().value),r(),l(t.texts[t.card().theme||0]),r(),p(" ",t.card().value," "),r(4),l(t.texts[t.card().theme||0]),r(),p(" ",t.card().title," "),r(),l(t.backgrounds[t.card().theme||0]))},dependencies:[A],styles:["[_nghost-%COMP%]{max-width:350pt}"]})}}return i})();var K=(i,c)=>c.index;function X(i,c){if(i&1&&(a(0,"li",5),s(1),o()),i&2){let e=c.$implicit;r(),p(" ",e.rule," ")}}var N=(()=>{class i{constructor(){this.letter="R",this.title="Pouvoir : Roi du regard",this.card=w.required(),this.rules=g(()=>this.card().rules.map((e,n)=>({index:n,rule:e}))),this.backgrounds=["bg-[#73B4BD]","bg-[#E6BF25]","bg-[#A8C521]","bg-[#996AC1]"],this.texts=["text-[#73B4BD]","text-[#E6BF25]","text-[#A8C521]","text-[#996AC1]"],this.borders=["border-[#73B4BD]","border-[#E6BF25]","border-[#A8C521]","border-[#996AC1]"]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=u({type:i,selectors:[["app-card-verso"]],inputs:{letter:"letter",title:"title",card:[1,"card"]},standalone:!0,features:[x],decls:12,vars:11,consts:[[1,"flex","items-center","justify-center","w-full","h-full","bg-white","rounded-3xl","relative","overflow-hidden","p-4","shadow-lg","border-4"],[1,"absolute","top-4","left-4","w-16","h-16","rounded-lg","flex","items-center","justify-center","z-20"],[1,"text-white","text-4xl","font-bold"],[1,"absolute","right-4","top-5","text-9xl","font-bold","opacity-20","z-20"],[1,"text-3xl","text-center","font-bold","leading-tight"],[1,"text-center","text-xl","leading-tight"]],template:function(n,t){n&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),s(3),o()(),a(4,"div",3),s(5),o(),a(6,"div")(7,"h2",4),s(8),o(),a(9,"ul"),F(10,X,2,1,"li",5,K),o()()()),n&2&&(l(t.borders[t.card().theme||0]),r(),l(t.backgrounds[t.card().theme||0]),r(2),f(t.card().value),r(),l(t.texts[t.card().theme||0]),r(),p(" ",t.card().value," "),r(2),l(t.texts[t.card().theme||0]),r(),p(" ",t.card().title," "),r(2),P(t.rules()))},dependencies:[A],styles:["[_nghost-%COMP%]{max-width:350pt}"]})}}return i})();var Z=["riveCanvas"],ee=i=>({"rotate-y-180":i}),te=i=>({"opacity-0":i}),ie=i=>({invisible:i});function ne(i,c){if(i&1&&(a(0,"h2",2),s(1," Au tour de "),a(2,"span",11),s(3),o()()),i&2){let e=m(2);r(3),f(e.game().player)}}function re(i,c){if(i&1&&v(0,"img",7),i&2){let e=m(2);T("src","titetes/",e.card.rive,"",V)}}function ae(i,c){if(i&1){let e=M();E(0,ne,4,1,"h2",2),a(1,"div",3),S("click",function(){_(e);let t=m();return y(t.isVerso.set(!t.isVerso()))}),a(2,"div",4)(3,"div",5)(4,"app-card",6),E(5,re,1,2,"img",7),v(6,"canvas",8,0),o()(),a(8,"div",9),v(9,"app-card-verso",6),o()()(),a(10,"button",10),S("click",function(){_(e);let t=m();return y(t.changeAnimation())}),s(11," Au suivant "),o()}if(i&2){let e=m();I(e.game().player?0:-1),r(2),h("ngClass",k(7,ee,e.isVerso())),r(),h("ngClass",k(9,te,e.isVerso())),r(),h("card",e.card),r(),I(e.game().isRive?-1:5),r(),h("ngClass",k(11,ie,!e.game().isRive)),r(3),h("card",e.card)}}function oe(i,c){if(i&1){let e=M();a(0,"h2",2),s(1,"La partie est finie"),o(),a(2,"button",12),S("click",function(){_(e);let t=m();return y(t.changeAnimation())}),s(3," Relancer une partie "),o()}}var ke=(()=>{class i{constructor(){this.#e=b(Q),this.#t=b(U),this.#i=b(q),this.card=this.#e.card(),this.isVerso=B(!1),this.game=g(()=>(this.card=this.#e.card(),this.card&&this.loadRiveAnimation(this.card.rive),{out:this.#e.cardsOut(),deck:this.#e.cards(),player:this.#e.currentPlayer(),card:this.#e.card(),isRive:!this.card?.rive.endsWith(".png")})),this.riveUrl="le_titube.riv",this.riveInstance=null}#e;#t;#i;ngOnInit(){window.addEventListener("resize",this.onResize.bind(this))}ngAfterViewInit(){this.initRenderer(),this.loadRiveAnimation(this.game().isRive?this.card?.rive:void 0)}ngOnDestroy(){window.removeEventListener("resize",this.onResize.bind(this))}initRenderer(){if(this.canvas)try{let e=this.canvas.nativeElement;e.width=e.offsetWidth,e.height=e.offsetHeight,this.riveInstance=new d.Rive({canvas:e,src:this.riveUrl,autoplay:!0,artboard:"lesTitous",layout:new d.Layout({fit:d.Fit.Contain,alignment:d.Alignment.Center}),onLoad:()=>{}})}catch(e){console.error("Erreur lors du chargement de l'animation Rive:",e)}}loadRiveAnimation(e){return R(this,null,function*(){this.riveInstance&&this.riveInstance.play(e)})}onResize(){if(this.riveInstance?.stop(),this.canvas&&this.riveInstance){let e=this.canvas.nativeElement,n=e.parentElement;n&&(e.width=n.clientWidth,e.height=n.clientHeight,this.loadRiveAnimation())}}changeAnimation(){this.#e.cards().length===0&&this.#e.reset(),this.isVerso.set(!1);let e=this.#i.getNextCardIndex(),n=this.#t.usernames(),t=this.#e.currentPlayer(),C=0;t&&(C=(n.indexOf(t)+1)%n.length),this.#e.addCarteOut(this.#e.cards()[e]),this.#e.setCurrentPlayer(n[C]),this.riveInstance&&this.game().isRive&&console.log({riveCard:this.card?.rive,riveInstance:this.riveInstance.contents})}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=u({type:i,selectors:[["app-game"]],viewQuery:function(n,t){if(n&1&&O(Z,5),n&2){let C;G(C=j())&&(t.canvas=C.first)}},standalone:!0,features:[x],decls:3,vars:1,consts:[["riveCanvas",""],[1,"flex","flex-col","justify-center","items-center","h-full"],[1,"text-4xl","font-bold"],[1,"relative","w-[80%]","h-full","perspective",3,"click"],[1,"relative","w-full","h-full","duration-700","preserve-3d",3,"ngClass"],[1,"absolute","w-full","h-full","backface-hidden","duration-300",3,"ngClass"],[1,"block","w-full","h-full",3,"card"],[1,"absolute","top-0","bottom-0","left-0","right-0","m-auto",3,"src"],["id","riveCanvas",3,"ngClass"],[1,"absolute","w-full","h-full","backface-hidden","rotate-y-180"],["routerLink","/lobby",1,"rounded-lg","py-2","px-4","h-[70pt]","bg-orange-500","w-[80%]","text-white","text-3xl","my-5",3,"click"],[1,"text-[#FA7B53]","font-bold"],[1,"rounded-lg","py-2","px-4","h-[70pt]","bg-orange-500","w-[80%]","text-white","text-3xl","my-5",3,"click"]],template:function(n,t){n&1&&(a(0,"div",1),E(1,ae,12,13)(2,oe,4,0),o()),n&2&&(r(),I(t.card?1:2))},dependencies:[H,N,L],styles:["canvas[_ngcontent-%COMP%]{width:100%;height:100%}.perspective[_ngcontent-%COMP%]{perspective:1000px}.preserve-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.backface-hidden[_ngcontent-%COMP%]{backface-visibility:hidden;justify-content:center;display:flex}.rotate-y-180[_ngcontent-%COMP%]{transform:rotateY(180deg)}"]})}}return i})();export{ke as GameComponent};
