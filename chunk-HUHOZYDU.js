import{a as Y}from"./chunk-U6M22WZH.js";import{a as Q,b as q}from"./chunk-DILD3EYX.js";import{f as L}from"./chunk-75J22X7U.js";import{Fa as A,Ia as r,Lb as f,Sa as B,Vb as j,Xb as S,Ya as w,_a as y,bb as l,cb as E,da as g,e as H,eb as V,f as M,fb as R,ga as p,gb as a,hb as o,ib as u,jb as k,lb as I,mb as c,nb as D,ob as P,pa as C,pb as z,qa as b,qb as F,rb as T,sb as O,ub as s,vb as h,wa as _,wb as m,yb as v,zb as G}from"./chunk-FNSXWPPW.js";var $=H(Y());var J=["*"],N=(()=>{class n{constructor(){this.letter="R",this.title="Pouvoir : Roi du regard",this.card=_.required(),this.rules=f(()=>this.card().rules.map((t,i)=>({index:i,rule:t}))),this.backgrounds=["bg-[#73B4BD]","bg-[#E6BF25]","bg-[#A8C521]","bg-[#996AC1]"],this.texts=["text-[#73B4BD]","text-[#E6BF25]","text-[#A8C521]","text-[#996AC1]"],this.borders=["border-[#73B4BD]","border-[#E6BF25]","border-[#A8C521]","border-[#996AC1]"]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=p({type:n,selectors:[["app-card"]],inputs:{letter:"letter",title:"title",card:[1,"card"]},standalone:!0,features:[v],ngContentSelectors:J,decls:12,vars:13,consts:[[1,"w-full","h-full","bg-white","rounded-3xl","relative","overflow-hidden","p-4","shadow-lg","border-4"],[1,"absolute","top-4","left-4","w-16","h-16","rounded-lg","flex","items-center","justify-center","z-20"],[1,"text-white","text-4xl","font-bold"],[1,"absolute","right-4","top-5","text-9xl","font-bold","opacity-20","z-20"],[1,"w-full","h-3/5","mt-20","relative","z-20"],[1,"absolute","bottom-[20px]","z-20"],[1,"text-3xl","text-center","font-bold","leading-tight"],[1,"absolute","bottom-0","left-0","h-[25vw]","w-[25vw]","min-w-[300pt]","min-h-[300pt]","max-h-[500px]","max-w-[500px]","rounded-full","-translate-x-[15%]","translate-y-[15%]","opacity-20","z-10"]],template:function(i,e){i&1&&(D(),a(0,"div",0)(1,"div",1)(2,"span",2),s(3),o()(),a(4,"div",3),s(5),o(),a(6,"div",4),P(7),o(),a(8,"div",5)(9,"h2",6),s(10),o()(),u(11,"div",7),o()),i&2&&(l(e.borders[e.card().theme||0]),r(),l(e.backgrounds[e.card().theme||0]),r(2),h(e.card().value),r(),l(e.texts[e.card().theme||0]),r(),m(" ",e.card().value," "),r(4),l(e.texts[e.card().theme||0]),r(),m(" ",e.card().title," "),r(),l(e.backgrounds[e.card().theme||0]))},dependencies:[S],styles:["[_nghost-%COMP%]{max-width:350pt}"]})}}return n})();var K=(n,d)=>d.index;function X(n,d){if(n&1&&(a(0,"li",5),s(1),o()),n&2){let t=d.$implicit;r(),m(" ",t.rule," ")}}var W=(()=>{class n{constructor(){this.letter="R",this.title="Pouvoir : Roi du regard",this.card=_.required(),this.rules=f(()=>this.card().rules.map((t,i)=>({index:i,rule:t}))),this.backgrounds=["bg-[#73B4BD]","bg-[#E6BF25]","bg-[#A8C521]","bg-[#996AC1]"],this.texts=["text-[#73B4BD]","text-[#E6BF25]","text-[#A8C521]","text-[#996AC1]"],this.borders=["border-[#73B4BD]","border-[#E6BF25]","border-[#A8C521]","border-[#996AC1]"]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=p({type:n,selectors:[["app-card-verso"]],inputs:{letter:"letter",title:"title",card:[1,"card"]},standalone:!0,features:[v],decls:12,vars:11,consts:[[1,"flex","items-center","justify-center","w-full","h-full","bg-white","rounded-3xl","relative","overflow-hidden","p-4","shadow-lg","border-4"],[1,"absolute","top-4","left-4","w-16","h-16","rounded-lg","flex","items-center","justify-center","z-20"],[1,"text-white","text-4xl","font-bold"],[1,"absolute","right-4","top-5","text-9xl","font-bold","opacity-20","z-20"],[1,"text-3xl","text-center","font-bold","leading-tight"],[1,"text-center","text-xl","leading-tight"]],template:function(i,e){i&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),s(3),o()(),a(4,"div",3),s(5),o(),a(6,"div")(7,"h2",4),s(8),o(),a(9,"ul"),V(10,X,2,1,"li",5,K),o()()()),i&2&&(l(e.borders[e.card().theme||0]),r(),l(e.backgrounds[e.card().theme||0]),r(2),h(e.card().value),r(),l(e.texts[e.card().theme||0]),r(),m(" ",e.card().value," "),r(2),l(e.texts[e.card().theme||0]),r(),m(" ",e.card().title," "),r(2),R(e.rules()))},dependencies:[S],styles:["[_nghost-%COMP%]{max-width:350pt}"]})}}return n})();var Z=["riveCanvas"],ee=n=>({"rotate-y-180":n});function te(n,d){if(n&1&&(a(0,"h2",2),s(1," Au tour de "),a(2,"span",11),s(3),o()()),n&2){let t=c(2);r(3),h(t.game().player)}}function ie(n,d){if(n&1&&u(0,"img",8),n&2){let t=c(2);z("src","titetes/",t.card.rive,"",A)}}function ne(n,d){if(n&1){let t=k();w(0,te,4,1,"h2",2),a(1,"div",3),I("click",function(){C(t);let e=c();return b(e.isVerso.set(!e.isVerso()))}),a(2,"div",4)(3,"div",5)(4,"app-card",6),u(5,"canvas",7,0),w(7,ie,1,2,"img",8),o()(),a(8,"div",9),u(9,"app-card-verso",6),o()()(),a(10,"button",10),I("click",function(){C(t);let e=c();return b(e.changeAnimation())}),s(11," Au suivant "),o()}if(n&2){let t=c();E(t.game().player?0:-1),r(2),y("ngClass",G(5,ee,t.isVerso())),r(2),y("card",t.card),r(3),E(t.game().isRive?-1:7),r(2),y("card",t.card)}}function re(n,d){if(n&1){let t=k();a(0,"h2",2),s(1,"La partie est finie"),o(),a(2,"button",12),I("click",function(){C(t);let e=c();return b(e.changeAnimation())}),s(3," Relancer une partie "),o()}}var Ie=(()=>{class n{constructor(){this.#e=g(q),this.#t=g(L),this.#i=g(Q),this.card=this.#e.card(),this.isVerso=B(!1),this.game=f(()=>(this.card=this.#e.card(),this.card&&this.loadRiveAnimation(this.card.rive),{out:this.#e.cardsOut(),deck:this.#e.cards(),player:this.#e.currentPlayer(),card:this.#e.card(),isRive:!this.card?.rive.endsWith(".png")})),this.riveUrl="le_titube.riv",this.riveInstance=null}#e;#t;#i;ngOnInit(){window.addEventListener("resize",this.onResize.bind(this))}ngAfterViewInit(){this.loadRiveAnimation()}ngOnDestroy(){window.removeEventListener("resize",this.onResize.bind(this))}loadRiveAnimation(t){return M(this,null,function*(){if(this.canvas)try{this.riveInstance=new $.Rive({canvas:this.canvas.nativeElement,src:this.riveUrl,autoplay:!0,artboard:"lesTitous",onLoad:()=>{t&&this.riveInstance?.play(t)}}),this.riveInstance.resizeToCanvas(),this.riveInstance.resizeDrawingSurfaceToCanvas(),console.log(this.riveInstance)}catch(i){console.error("Erreur lors du chargement de l'animation Rive:",i)}})}onResize(){if(this.riveInstance?.stop(),this.canvas&&this.riveInstance){let t=this.canvas.nativeElement,i=t.parentElement;i&&(t.width=i.clientWidth,t.height=i.clientHeight,this.loadRiveAnimation())}}changeAnimation(){this.isVerso.set(!1);let t=this.#i.getNextCardIndex(),i=this.#t.usernames(),e=this.#e.currentPlayer(),x=0;e&&(x=(i.indexOf(e)+1)%i.length),this.#e.addCarteOut(this.#e.cards()[t]),this.#e.setCurrentPlayer(i[x]),console.log(this.game()),this.riveInstance&&this.game().isRive&&console.log({riveCard:this.card?.rive,riveInstance:this.riveInstance.contents})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=p({type:n,selectors:[["app-game"]],viewQuery:function(i,e){if(i&1&&F(Z,5),i&2){let x;T(x=O())&&(e.canvas=x.first)}},standalone:!0,features:[v],decls:3,vars:1,consts:[["riveCanvas",""],[1,"flex","flex-col","justify-center","items-center","h-full"],[1,"text-4xl","font-bold"],[1,"relative","w-[80%]","h-full","perspective",3,"click"],[1,"relative","w-full","h-full","duration-700","preserve-3d",3,"ngClass"],[1,"absolute","w-full","h-full","backface-hidden"],[1,"block","w-full","h-full",3,"card"],["id","riveCanvas"],[1,"absolute","top-0","bottom-0","left-0","right-0","m-auto",3,"src"],[1,"absolute","w-full","h-full","backface-hidden","rotate-y-180"],["routerLink","/lobby",1,"rounded-lg","py-2","px-4","h-[70pt]","bg-orange-500","w-[80%]","text-white","text-3xl","my-5",3,"click"],[1,"text-[#FA7B53]","font-bold"],[1,"rounded-lg","py-2","px-4","h-[70pt]","bg-orange-500","w-[80%]","text-white","text-3xl","my-5",3,"click"]],template:function(i,e){i&1&&(a(0,"div",1),w(1,ne,12,7)(2,re,4,0),o()),i&2&&(r(),E(e.card?1:2))},dependencies:[N,W,j],styles:["canvas[_ngcontent-%COMP%]{width:100%;height:100%}.perspective[_ngcontent-%COMP%]{perspective:1000px}.preserve-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.backface-hidden[_ngcontent-%COMP%]{backface-visibility:hidden}.rotate-y-180[_ngcontent-%COMP%]{transform:rotateY(180deg)}"]})}}return n})();export{Ie as GameComponent};
